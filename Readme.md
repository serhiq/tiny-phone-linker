# Telegram Messaging API Service

## Описание проекта

Прокси-бот для Телеграма. Бот сохраняет телефонные номера и Telegram ID для отправки сообщений через API.

## Ключевые возможности
- Регистрация и связывание номера телефона пользователя с его Telegram ID.
- отправка текстовых сообщений через REST API.

## Технологии
- **MySQL**: СУБД для хранения данных.
- **gopkg.in/telebot.v3**: api для взаимодействия с телеграмм
- **Zap**: Библиотека для логирования в Go.

### Описание структуры базы данных `sbot_db`

**Название таблицы:** `user_phone_mapping`

**Описание:** Таблица используется для хранения соответствия между номерами телефонов пользователей и их идентификаторами в Telegram. Это позволяет принимать запросы по API, используя номер телефона, и преобразовывать его в идентификатор пользователя для отправки сообщений.

**Структура таблицы:**

| Поле | Тип данных | Описание |
| --- | --- | --- |
| `phone_number` | `VARCHAR(16)` | Номер телефона пользователя. Уникальное поле, используемое как первичный ключ. |
| `telegram_id` | `int(10)` | Идентификатор чата пользователя в Telegram. |
| `created_at` | `TIMESTAMP` | Время создания записи. По умолчанию устанавливается текущее время. |
| `updated_at` | `TIMESTAMP` | Время последнего обновления записи. Обновляется автоматически при изменении записи. |
| `deleted_at` | `TIMESTAMP` | Время удаления записи. Если поле заполнено, считается, что запись удалена. |

- **Первичный ключ:** `phone_number`

Эта структура поддерживает быстрый поиск и обновление данных, обеспечивая эффективное взаимодействие с API для обработки сообщений в Telegram на основе номера телефона пользователя.

### Описание API Endpoint

**POST /v1/messages/**

Данный endpoint позволяет отправлять текстовые сообщения пользователям. Он принимает JSON-объект с номером телефона получателя и текстом сообщения.

**Тело запроса:**

```json
{
  "phone": "{{Recipient-Phone-Number}}",
  "type": "text"
}
```

### Параметры запроса

| Параметр | Тип    | Описание                             |
|----------|--------|--------------------------------------|
| `phone`  | строка | Номер телефона получателя сообщения. |
| `text`   | строка | текствое сообщение                   |
**Пример использования:**

Чтобы отправить сообщение "Привет" на номер "1234567890", тело запроса будет выглядеть следующим образом:

```json
{
  "phone": "1234567890",
  "text": "text"
}
```

**Ответы сервера:**

- `200 OK`: сообщение успешно отправлено.
- `400 Bad Request`: ошибка в данных запроса.
- `401 Unauthorized`: ошибка аутентификации. Отсутствует или неверный токен аутентификации.
- `404`: пользователь не найден
- `500 Internal Server Error`: внутренняя ошибка сервера.

### Аутентификация

Для использования данного API необходимо включить в заголовки запроса токен аутентификации. Пример заголовка:

```text
Authorization: YOUR_ACCESS_TOKEN`
```




